# Railway Deployment Guide

This document describes how to deploy Zyra to Railway.

## Project Setup

Currently linked to:
- **Project Name**: Digital Cluster 25
- **Service Name**: Postgres
- **Environment**: production
- **Database**: PostgreSQL

Alternative standalone project available:
- **Project Name**: Zyra (ID: aef7625d-578e-4016-a0dc-c2fe680eabe7)

To switch to the standalone Zyra project:
```bash
railway link aef7625d-578e-4016-a0dc-c2fe680eabe7
```

## Prerequisites

1. Railway CLI installed and authenticated
2. Railway project linked to this repository
3. PostgreSQL service added to the project

## Environment Variables

Railway automatically provides the following variables:

```bash
DATABASE_URL=postgresql://postgres:PASSWORD@postgres.railway.internal:5432/railway
PGHOST=postgres.railway.internal
PGPORT=5432
PGUSER=postgres
PGPASSWORD=<auto-generated>
PGDATABASE=railway
```

### Additional Variables to Set

Set these in Railway dashboard or via CLI:

```bash
NEXT_PUBLIC_APP_URL=https://zyra.up.railway.app
NODE_ENV=production
```

## Deployment

### Via CLI

```bash
# Link to Railway project (already done)
railway link

# Deploy
railway up

# Or with specific environment
railway up --environment production
```

### Via GitHub

Railway automatically deploys when you push to the main branch.

## Database Migrations

After deployment, run migrations:

```bash
# Via Railway CLI
railway run npx prisma migrate deploy

# Or connect to service and run
railway run --service Postgres npx prisma migrate deploy
```

## Useful Commands

```bash
# View logs
railway logs

# Open Prisma Studio
railway run npx prisma studio

# Check service status
railway status

# List variables
railway vars

# Set a variable
railway vars set KEY=VALUE
```

## Domain Configuration

Railway provides a default domain: `zyra.up.railway.app`

To add a custom domain:
1. Go to Railway dashboard
2. Select your service
3. Settings → Domains
4. Add your custom domain

## Troubleshooting

### Database Connection Issues

Check DATABASE_URL is correctly set:
```bash
railway vars | grep DATABASE_URL
```

### Build Failures

View build logs:
```bash
railway logs --deployment
```

### Migration Issues

Reset migrations (⚠️ destructive):
```bash
railway run npx prisma migrate reset
```
